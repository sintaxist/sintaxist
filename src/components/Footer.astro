---
import LogoHeader from "@/components/ui/LogoHeader.astro";
import { socialLinks } from '@/data/links.js';

const { t, sections } = Astro.props;
const currentYear = new Date().getFullYear();

const menuItems = [
  { id: "projects", label: sections.projects },
  { id: "experience", label: sections.experience },
  { id: "aboutMe", label: sections.aboutMe },
  { id: "skills", label: sections.skills },
  { id: "contact", label: sections.contact },
];
---

<footer
  class="w-full bg-primary text-secondary pt-16 pb-8 px-6 md:px-8"
>
  <div class="max-w-screen-2xl mx-auto">
    <div class="grid md:grid-cols-3 gap-12 mb-12 text-center md:text-left">
      <div class="flex flex-col gap-4 items-center md:items-start">
        <a href="#home" class="logo-footer-link mb-4 transition-all hover:text-primary-hover" title="Logo Alejandro Canek" aria-label="Logo Alejandro Canek">
          <LogoHeader class="h-12 md:h-15"/>
        </a>
        <p class="font-secondary text-sm xs:text-base sm:text-md md:text-lg">
          {t.bio}
        </p>
      </div>

      <div>
        <h4 class="font-primary text-xl uppercase tracking-wider mb-4">
          {t.navigationTitle}
        </h4>
        <ul class="space-y-3 font-secondary">
          {
            menuItems.map((item) => (
              <li>
                <a
                  href={`#${item.id}`}
                  class="link-style font-secondary text-sm xs:text-base sm:text-md md:text-lg"
                >
                  {item.label}
                </a>
              </li>
            ))
          }
        </ul>
      </div>

      <div>
        <h4 class="font-primary text-xl uppercase tracking-wider mb-4">
          {t.connectTitle}
        </h4>
        <div class="flex space-x-4 justify-center md:justify-start">
          {
            socialLinks.map(link => (
              <a 
                href={link.url}
                target="_blank"
                rel="noopener noreferrer"
                aria-label={link.ariaLabel}
                title={link.name}
                class="text-secondary transition-transform hover:-translate-y-1"
              >
                <link.icon class="w-7 h-7" />
              </a>
            ))
          }
        </div>
      </div>
    </div>

    <div class="pt-8 border-t border-secondary/50">
      <p class="text-secondary text-sm text-center font-secondary">
        Â© {currentYear} {t.copyright}
      </p>
    </div>
  </div>
</footer>

<style>
  .link-style {
    position: relative;
    padding-bottom: 4px;
  }

  .link-style:before {
    content: "";
    width: 0;
    height: 1px;
    background-color: var(--color-secondary);
    position: absolute;
    bottom: 0;
    left: 0;
    transition: width 0.3s ease-out;
  }

  .link-style:hover:before {
    width: 100%;
  }
</style>

<script>
  function smoothScroll(target) {
    const start = window.scrollY;
    const end = target.getBoundingClientRect().top + window.scrollY - 150;
    const duration = 50;
    let startTime = null;

    function easeInOutQuad(t) {
      return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;
    }

    function animation(currentTime) {
      if (startTime === null) startTime = currentTime;
      const timeElapsed = currentTime - startTime;
      const progress = Math.min(timeElapsed / duration, 1);
      const run = start + (end - start) * easeInOutQuad(progress);
      window.scrollTo(0, run);
      if (timeElapsed < duration) {
        requestAnimationFrame(animation);
      }
    }

    requestAnimationFrame(animation);
  }

  document.addEventListener("astro:page-load", () => {
    const footerLinks = document.querySelectorAll("footer a[href^='#']");
    footerLinks.forEach((link) => {
      link.addEventListener("click", (e) => {
        const href = link.getAttribute("href");
        if (!href || !href.startsWith('#')) return;
        
        const targetId = href.substring(1);
        const targetEl = document.getElementById(targetId);

        if (targetEl) {
          e.preventDefault();
          smoothScroll(targetEl);
        }
      });
    });

    const logoLink = document.querySelector('.logo-footer-link');
    if (logoLink) {
      logoLink.addEventListener('click', (e) => {
        const homeSection = document.getElementById('home');
        if (homeSection) {
          e.preventDefault();
          smoothScroll(homeSection);
        }
      });
    }
  });
</script>