---
import Layout from "@/layouts/Layout.astro";

import HeroSection from "@/sections/HeroSection.astro";
import AboutSection from "@/sections/AboutSection.astro";
import ContactSection from "@/sections/ContactSection.astro";

import { LANGUAGES, defaultLang, type AppLocale } from "@/locales";
import ExperiencieSkillsSection from "@/sections/ExperiencieSkillsSection.astro";
import ProjectsSection from "@/sections/ProjectsSection.astro";

export async function getStaticPaths() {
  const paths = [];

  for (const lang of Object.keys(LANGUAGES)) {
    const t = LANGUAGES[lang].translations;

    // Filtramos los proyectos (solo los 4 primeros y con datos mÃ­nimos)
    const filteredProjects = t.projects_page.projects
      .slice(0, 6)
      .map((p) => ({
        slug: p.slug,
        title: p.title,
        description: p.description,
        categoryIds: p.categoryIds,
        imgSrc: p.imgSrc,
      }));

    // Solo los campos necesarios del projects_page
    const projectsPage = {
      title: t.projects_page.title,
      description: t.projects_page.description,
      cta_all_projects: t.projects_page.cta_all_projects,
      view_more: t.projects_page.view_more,
      categories: t.projects_page.categories,
      projects: filteredProjects,
    };

    // Desestructuramos lo necesario y lo pasamos directo como props
    paths.push({
      params: { lang },
      props: {
        lang,
        header: t.header,
        hero: t.hero,
        about: t.about,
        experience: t.experience,
        skills: t.skills,
        contact: t.contact,
        socials: t.socials,
        footer: t.footer,
        sections: t.sections,
        projectsPage,
      },
    });
  }

  return paths;
}

const {
  lang,
  header,
  hero,
  about,
  experience,
  skills,
  contact,
  socials,
  footer,
  projectsPage,
  sections,
} = Astro.props;
---

<Layout
  title="Alejandro Canek - UX Engineer"
  description="Invitaciones Digitales para Eventos Inolvidables."
  headerInfo={header}
  sections={sections}
  footerInfo={footer}
>
  <HeroSection t={hero} socials={socials} />
  <AboutSection t={about} />
  <ProjectsSection t={projectsPage} {lang} />
  <ExperiencieSkillsSection experience={experience} skills={skills} />
  <ContactSection t={contact} socials={socials} />
</Layout>
